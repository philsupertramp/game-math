\hypertarget{matrix__utils_8h_source}{}\doxysection{matrix\+\_\+utils.\+h}
\label{matrix__utils_8h_source}\index{include/math/matrix\_utils.h@{include/math/matrix\_utils.h}}
\mbox{\hyperlink{matrix__utils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Matrix_8h}{Matrix.h}}"{}}}
\DoxyCodeLine{4 }
\DoxyCodeLine{16 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{17 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_ace948cba52caa75f48454f881bc51a68}{HadamardMulti}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& rhs) \{}
\DoxyCodeLine{18   lhs.\mbox{\hyperlink{classMatrix_a7ff3adb55a7fcd61963647884d97cbd1}{assertSize}}(rhs);}
\DoxyCodeLine{19   \textcolor{keyword}{auto} result = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{20   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < result.rows(); i++) \{}
\DoxyCodeLine{21     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < result.columns(); j++) \{}
\DoxyCodeLine{22       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < result.elements(); elem++) \{ result(i, j, elem) = lhs(i, j, elem) * rhs(i, j, elem); \}}
\DoxyCodeLine{23     \}}
\DoxyCodeLine{24   \}}
\DoxyCodeLine{25   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{26 \}}
\DoxyCodeLine{27 }
\DoxyCodeLine{35 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{36 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_aaa7678f560359b32faa3d233e7788f3d}{HadamardDiv}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& rhs) \{}
\DoxyCodeLine{37   lhs.\mbox{\hyperlink{classMatrix_a7ff3adb55a7fcd61963647884d97cbd1}{assertSize}}(rhs);}
\DoxyCodeLine{38   \textcolor{keyword}{auto} result = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{39   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < result.rows(); i++) \{}
\DoxyCodeLine{40     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < result.columns(); j++) \{}
\DoxyCodeLine{41       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < result.elements(); elem++) \{ result(i, j, elem) = lhs(i, j, elem) / rhs(i, j, elem); \}}
\DoxyCodeLine{42     \}}
\DoxyCodeLine{43   \}}
\DoxyCodeLine{44   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{45 \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{55 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{56 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_a93aa2d642177c606086b7ed35dbd634c}{KroneckerMulti}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& rhs) \{}
\DoxyCodeLine{57   assert(lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() == rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{58   \textcolor{keyword}{auto} result = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() * rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() * rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{59   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} m = 0; m < lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); m++) \{}
\DoxyCodeLine{60     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} n = 0; n < lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); n++) \{}
\DoxyCodeLine{61       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} p = 0; p < rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); p++) \{}
\DoxyCodeLine{62         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} q = 0; q < rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); q++) \{}
\DoxyCodeLine{63           \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); elem++) \{}
\DoxyCodeLine{64             result(m * rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() + p, n * rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() + q, elem) = lhs(m, n, elem) * rhs(p, q, elem);}
\DoxyCodeLine{65           \}}
\DoxyCodeLine{66         \}}
\DoxyCodeLine{67       \}}
\DoxyCodeLine{68     \}}
\DoxyCodeLine{69   \}}
\DoxyCodeLine{70   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{71 \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{80 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{81 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_a1f9177b021b6f3a2ec3a4f0b26797b8e}{HorizontalConcat}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& lhs, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& rhs) \{}
\DoxyCodeLine{82   assert(lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() == rhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{83   assert(lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() == rhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{84   \textcolor{keyword}{auto} result = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0.0, lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() + rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{85   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < lhs.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); ++i) \{}
\DoxyCodeLine{86     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() + rhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); ++j) \{}
\DoxyCodeLine{87       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < lhs.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); ++elem) \{}
\DoxyCodeLine{88         result(i, j, elem) = j < lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() ? lhs(i, j, elem) : rhs(i, j -\/ lhs.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), elem);}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91   \}}
\DoxyCodeLine{92   \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{93 \}}
\DoxyCodeLine{94 }
\DoxyCodeLine{102 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{103 \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{matrix__utils_8h_a0a35c20e3d36bb16e1ae7e4dbaae29ce}{Corr}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& A, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& B) \{}
\DoxyCodeLine{104   A.\mbox{\hyperlink{classMatrix_a7ff3adb55a7fcd61963647884d97cbd1}{assertSize}}(B);}
\DoxyCodeLine{105   \textcolor{keywordtype}{size\_t} count = 0;}
\DoxyCodeLine{106   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < A.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{107     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < A.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{108       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < A.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); elem++) \{ count += (A(i, j, elem) == B(i, j, elem)); \}}
\DoxyCodeLine{109     \}}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111   \textcolor{keywordflow}{return} count;}
\DoxyCodeLine{112 \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{121 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{122 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_abcd4628e1dd87e594aa69c1e9e60cd19}{from\_vptr}}(\textcolor{keyword}{const} T* value, \mbox{\hyperlink{structMatrixDimension}{MatrixDimension}} size) \{}
\DoxyCodeLine{123   \textcolor{keyword}{auto} out = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, size.\mbox{\hyperlink{structMatrixDimension_a93df531cf74c1c3a6d6c0519cb2789ef}{rows}}, size.\mbox{\hyperlink{structMatrixDimension_aef50c3f8f188346f84c30f0dae35436d}{columns}});}
\DoxyCodeLine{124   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < size.\mbox{\hyperlink{structMatrixDimension_a93df531cf74c1c3a6d6c0519cb2789ef}{rows}}; i++) \{}
\DoxyCodeLine{125     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < size.\mbox{\hyperlink{structMatrixDimension_aef50c3f8f188346f84c30f0dae35436d}{columns}}; j++) \{}
\DoxyCodeLine{126       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < size.\mbox{\hyperlink{structMatrixDimension_a1f5be55c8a60262ddb045e4d3f4310e1}{elemDim}}; elem++) \{}
\DoxyCodeLine{127         out(i, j, elem) = value[elem + j * size.\mbox{\hyperlink{structMatrixDimension_a1f5be55c8a60262ddb045e4d3f4310e1}{elemDim}} + i * size.\mbox{\hyperlink{structMatrixDimension_aef50c3f8f188346f84c30f0dae35436d}{columns}} * size.\mbox{\hyperlink{structMatrixDimension_a1f5be55c8a60262ddb045e4d3f4310e1}{elemDim}}];}
\DoxyCodeLine{128       \}}
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130   \}}
\DoxyCodeLine{131   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{132 \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{142 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{143 \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{matrix__utils_8h_a2a01e8ac881ea58d279cd73ec1803444}{argmax}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat) \{}
\DoxyCodeLine{144   T maxVal        = std::numeric\_limits<T>::min();}
\DoxyCodeLine{145   \textcolor{keywordtype}{size\_t} maxIndex = -\/1;}
\DoxyCodeLine{146   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{147     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{148       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); elem++) \{}
\DoxyCodeLine{149         \textcolor{keywordflow}{if}(mat(i, j, elem) > maxVal) \{}
\DoxyCodeLine{150           maxVal   = mat(i, j, elem);}
\DoxyCodeLine{151           maxIndex = elem + j * mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() + i * mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() * mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();}
\DoxyCodeLine{152         \}}
\DoxyCodeLine{153       \}}
\DoxyCodeLine{154     \}}
\DoxyCodeLine{155   \}}
\DoxyCodeLine{156   \textcolor{keywordflow}{return} maxIndex;}
\DoxyCodeLine{157 \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{166 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{167 \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{matrix__utils_8h_a14c028e4d81577bbda70dd22db04afe8}{argmin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat) \{}
\DoxyCodeLine{168   T maxVal        = std::numeric\_limits<T>::max();}
\DoxyCodeLine{169   \textcolor{keywordtype}{size\_t} maxIndex = -\/1;}
\DoxyCodeLine{170   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{171     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{172       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); ++elem) \{}
\DoxyCodeLine{173         \textcolor{keywordflow}{if}(mat(i, j, elem) < maxVal) \{}
\DoxyCodeLine{174           maxVal   = mat(i, j, elem);}
\DoxyCodeLine{175           maxIndex = elem + j * mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() + i * mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() * mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}();}
\DoxyCodeLine{176         \}}
\DoxyCodeLine{177       \}}
\DoxyCodeLine{178     \}}
\DoxyCodeLine{179   \}}
\DoxyCodeLine{180   \textcolor{keywordflow}{return} maxIndex;}
\DoxyCodeLine{181 \}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 }
\DoxyCodeLine{193 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{194 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_afb3f7de2743f10b710460feb9c0f9009}{where}}(}
\DoxyCodeLine{195 \textcolor{keyword}{const} std::function<\textcolor{keywordtype}{bool}(T)>\& condition, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& in, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& valIfTrue, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& valIfFalse) \{}
\DoxyCodeLine{196   assert(valIfTrue.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() == valIfFalse.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() \&\& valIfTrue.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() == valIfFalse.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{197   \textcolor{keywordtype}{bool} refVector = \textcolor{keyword}{true};}
\DoxyCodeLine{198   \textcolor{keywordflow}{if}((valIfTrue.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() == valIfTrue.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()) == 1) \{ refVector = \textcolor{keyword}{false}; \}}
\DoxyCodeLine{199   \textcolor{keyword}{auto} out = refVector ? valIfTrue : \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{200 }
\DoxyCodeLine{201   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{202     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{203       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); elem++) \{}
\DoxyCodeLine{204         \textcolor{keywordflow}{if}(refVector) \{}
\DoxyCodeLine{205           \textcolor{keywordflow}{if}(!condition(in(i, j, elem))) out(i, j, elem) = valIfFalse(i, j);}
\DoxyCodeLine{206           \textcolor{keywordflow}{else}}
\DoxyCodeLine{207             out(i, j, elem) = in(i, j, elem);}
\DoxyCodeLine{208         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{209           out(i, j, elem) = condition(in(i, j, elem)) ? valIfTrue(0, 0) : valIfFalse(0, 0);}
\DoxyCodeLine{210         \}}
\DoxyCodeLine{211       \}}
\DoxyCodeLine{212     \}}
\DoxyCodeLine{213   \}}
\DoxyCodeLine{214   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{215 \}}
\DoxyCodeLine{216 }
\DoxyCodeLine{224 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{225 \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}} \mbox{\hyperlink{matrix__utils_8h_ae294329feebecaabb007edfe6a36d830}{where\_value}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& in, T value) \{}
\DoxyCodeLine{226   assert(in.\mbox{\hyperlink{classMatrix_afae3fd51682a7d647fc87702252ceff3}{IsVector}}());}
\DoxyCodeLine{227   \textcolor{keywordtype}{bool} requires\_transposition = in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() < in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}();}
\DoxyCodeLine{228   \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}} out          = \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}}(0, !requires\_transposition ? in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() : in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(), 1);}
\DoxyCodeLine{229   \textcolor{keywordtype}{size\_t} found\_vals           = 0;}
\DoxyCodeLine{230   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < (!requires\_transposition ? in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() : in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()); ++i) \{}
\DoxyCodeLine{231     \textcolor{keywordflow}{if}(in(requires\_transposition ? 0 : i, requires\_transposition ? i : 0) == value) \{}
\DoxyCodeLine{232       out(found\_vals, 0) = i;}
\DoxyCodeLine{233       found\_vals++;}
\DoxyCodeLine{234     \}}
\DoxyCodeLine{235   \}}
\DoxyCodeLine{236   \textcolor{keywordflow}{return} requires\_transposition ? out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0, found\_vals -\/ 1).\mbox{\hyperlink{classMatrix_a054a03bcae4eb86d6f4ef84dc87840ef}{Transpose}}() : out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0, found\_vals -\/ 1);}
\DoxyCodeLine{237 \}}
\DoxyCodeLine{245 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{246 \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}} \mbox{\hyperlink{matrix__utils_8h_a06d4149d83f11dbd6ae1ea8a51cdfa12}{where\_true}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& in) \{}
\DoxyCodeLine{247   \textcolor{keywordflow}{return} \mbox{\hyperlink{matrix__utils_8h_ae294329feebecaabb007edfe6a36d830}{where\_value}}(in, 1.0);}
\DoxyCodeLine{248 \}}
\DoxyCodeLine{256 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{257 \mbox{\hyperlink{classMatrix}{Matrix<size\_t>}} \mbox{\hyperlink{matrix__utils_8h_ad9e4f7e23e67730cd255288face8d8d3}{where\_false}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& in) \{}
\DoxyCodeLine{258   \textcolor{keywordflow}{return} \mbox{\hyperlink{matrix__utils_8h_ae294329feebecaabb007edfe6a36d830}{where\_value}}(in, 0.0);}
\DoxyCodeLine{259 \}}
\DoxyCodeLine{260 }
\DoxyCodeLine{261 }
\DoxyCodeLine{270 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{271 std::vector<std::pair<Matrix<T>, \mbox{\hyperlink{classMatrix}{Matrix<T>}}>> \mbox{\hyperlink{matrix__utils_8h_a98433477e0327bd2ee165374375275e1}{zip}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& a, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& b) \{}
\DoxyCodeLine{272   std::vector<std::pair<Matrix<T>, \mbox{\hyperlink{classMatrix}{Matrix<T>}}>> out(a.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}());}
\DoxyCodeLine{273   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < a.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{274     \mbox{\hyperlink{classMatrix}{Matrix<T>}} subA, subB;}
\DoxyCodeLine{275     subA.\mbox{\hyperlink{classMatrix_a9483215681a238c3da0e385c3a31fe16}{Resize}}(1, a.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{276     subB.\mbox{\hyperlink{classMatrix_a9483215681a238c3da0e385c3a31fe16}{Resize}}(1, b.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{277     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < a.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{ subA(0, j) = a(i, j); \}}
\DoxyCodeLine{278     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < b.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{ subB(0, j) = b(i, j); \}}
\DoxyCodeLine{279 }
\DoxyCodeLine{280     out[i] = \{ subA, subB \};}
\DoxyCodeLine{281   \}}
\DoxyCodeLine{282   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{283 \}}
\DoxyCodeLine{284 }
\DoxyCodeLine{291 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{292 T \mbox{\hyperlink{matrix__utils_8h_a8dd66fbac5097923b2ecf481b0ae77e5}{max}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat) \{}
\DoxyCodeLine{293   T maxVal = std::numeric\_limits<T>::min();}
\DoxyCodeLine{294   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{295     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{296       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} k = 0; k < mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); k++) \{}
\DoxyCodeLine{297         \textcolor{keywordflow}{if}(mat(i, j, k) > maxVal) \{ maxVal = mat(i, j, k); \}}
\DoxyCodeLine{298       \}}
\DoxyCodeLine{299     \}}
\DoxyCodeLine{300   \}}
\DoxyCodeLine{301   \textcolor{keywordflow}{return} maxVal;}
\DoxyCodeLine{302 \}}
\DoxyCodeLine{303 }
\DoxyCodeLine{304 }
\DoxyCodeLine{305 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{306 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_a8dd66fbac5097923b2ecf481b0ae77e5}{max}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat, \textcolor{keywordtype}{int} axis) \{}
\DoxyCodeLine{307   \textcolor{keywordtype}{bool} row\_wise = axis == 0;}
\DoxyCodeLine{308   \mbox{\hyperlink{classMatrix}{Matrix<T>}} out = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, row\_wise ? 1 : mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), row\_wise ? mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() : 1);}
\DoxyCodeLine{309 }
\DoxyCodeLine{310   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < (row\_wise ? mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() : mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()); i++) \{}
\DoxyCodeLine{311     out(row\_wise ? 0 : i, row\_wise ? i : 0) = \mbox{\hyperlink{matrix__utils_8h_adf917f83162312bfe4a7a861c6f0cbcb}{elemMax}}(}
\DoxyCodeLine{312     mat.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise ? 0 : i, row\_wise ? mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1 : i, row\_wise ? i : 0, row\_wise ? i : mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1),}
\DoxyCodeLine{313     0);}
\DoxyCodeLine{314   \}}
\DoxyCodeLine{315   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{316 \}}
\DoxyCodeLine{323 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{324 T \mbox{\hyperlink{matrix__utils_8h_a4bb73e4029612f323f406f1ecfc2ed57}{min}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat) \{}
\DoxyCodeLine{325   T minVal = std::numeric\_limits<T>::max();}
\DoxyCodeLine{326   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{327     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{328       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} k = 0; k < mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); k++) \{}
\DoxyCodeLine{329         \textcolor{keywordflow}{if}(mat(i, j, k) < minVal) \{ minVal = mat(i, j, k); \}}
\DoxyCodeLine{330       \}}
\DoxyCodeLine{331     \}}
\DoxyCodeLine{332   \}}
\DoxyCodeLine{333   \textcolor{keywordflow}{return} minVal;}
\DoxyCodeLine{334 \}}
\DoxyCodeLine{335 }
\DoxyCodeLine{336 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{337 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_a4bb73e4029612f323f406f1ecfc2ed57}{min}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat, \textcolor{keywordtype}{int} axis) \{}
\DoxyCodeLine{338   \textcolor{keywordtype}{bool} row\_wise = axis == 0;}
\DoxyCodeLine{339   \mbox{\hyperlink{classMatrix}{Matrix<T>}} out = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, row\_wise ? 1 : mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), row\_wise ? mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() : 1);}
\DoxyCodeLine{340 }
\DoxyCodeLine{341   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < (row\_wise ? mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() : mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}()); i++) \{}
\DoxyCodeLine{342     out(row\_wise ? 0 : i, row\_wise ? i : 0) = \mbox{\hyperlink{matrix__utils_8h_a45d36755afc757808fcf8e6dc7a2c063}{elemMin}}(}
\DoxyCodeLine{343     mat.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise ? 0 : i, row\_wise ? mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1 : i, row\_wise ? i : 0, row\_wise ? i : mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1),}
\DoxyCodeLine{344     0);}
\DoxyCodeLine{345   \}}
\DoxyCodeLine{346   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{347 \}}
\DoxyCodeLine{348 }
\DoxyCodeLine{349 }
\DoxyCodeLine{357 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{358 T \mbox{\hyperlink{matrix__utils_8h_adf917f83162312bfe4a7a861c6f0cbcb}{elemMax}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t}\& elemIndex) \{}
\DoxyCodeLine{359   assert(mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() -\/ 1 >= elemIndex);}
\DoxyCodeLine{360   T maxVal     = std::numeric\_limits<T>::min();}
\DoxyCodeLine{361   \textcolor{keywordtype}{size\_t} index = 0;}
\DoxyCodeLine{362   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{363     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{364       \textcolor{keywordflow}{if}(mat(i, j, elemIndex) > maxVal) \{ maxVal = mat(i, j, elemIndex); \}}
\DoxyCodeLine{365       index++;}
\DoxyCodeLine{366     \}}
\DoxyCodeLine{367   \}}
\DoxyCodeLine{368   \textcolor{keywordflow}{return} maxVal;}
\DoxyCodeLine{369 \}}
\DoxyCodeLine{370 }
\DoxyCodeLine{378 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{379 T \mbox{\hyperlink{matrix__utils_8h_a45d36755afc757808fcf8e6dc7a2c063}{elemMin}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t}\& elemIndex) \{}
\DoxyCodeLine{380   assert(mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() -\/ 1 >= elemIndex);}
\DoxyCodeLine{381   T maxVal     = std::numeric\_limits<T>::max();}
\DoxyCodeLine{382   \textcolor{keywordtype}{size\_t} index = 0;}
\DoxyCodeLine{383   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{384     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{385       \textcolor{keywordflow}{if}(mat(i, j, elemIndex) < maxVal) \{ maxVal = mat(i, j, elemIndex); \}}
\DoxyCodeLine{386       index++;}
\DoxyCodeLine{387     \}}
\DoxyCodeLine{388   \}}
\DoxyCodeLine{389   \textcolor{keywordflow}{return} maxVal;}
\DoxyCodeLine{390 \}}
\DoxyCodeLine{391 }
\DoxyCodeLine{400 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{401 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_a23bb7f728122a09c240223a4de6730a9}{mean}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat, \textcolor{keywordtype}{int} axis = -\/1) \{}
\DoxyCodeLine{402   \textcolor{keywordflow}{if}(axis == -\/1) \{}
\DoxyCodeLine{403     \mbox{\hyperlink{classMatrix}{Matrix<T>}} sum = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, 1, 1);}
\DoxyCodeLine{404     T index       = 0;}
\DoxyCodeLine{405     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{406       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{407         sum(0, 0) += mat(i, j);}
\DoxyCodeLine{408         index++;}
\DoxyCodeLine{409       \}}
\DoxyCodeLine{410     \}}
\DoxyCodeLine{411     \textcolor{keywordflow}{return} (1.0 / index) * sum;}
\DoxyCodeLine{412   \}}
\DoxyCodeLine{413   \textcolor{keywordtype}{bool} row\_wise = axis == 0;}
\DoxyCodeLine{414 }
\DoxyCodeLine{415   \mbox{\hyperlink{classMatrix}{Matrix<T>}} sum = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, row\_wise ? 1 : mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), row\_wise ? mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() : 1);}
\DoxyCodeLine{416   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < (row\_wise ? mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() : mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()); i++) \{}
\DoxyCodeLine{417     sum +=}
\DoxyCodeLine{418     mat.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise ? i : 0, row\_wise ? i : mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, row\_wise ? 0 : i, row\_wise ? mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1 : i);}
\DoxyCodeLine{419   \}}
\DoxyCodeLine{420   \textcolor{keywordflow}{return} (1.0 / (row\_wise ? mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() : mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}())) * sum;}
\DoxyCodeLine{421 \}}
\DoxyCodeLine{422 }
\DoxyCodeLine{430 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{431 T \mbox{\hyperlink{matrix__utils_8h_aaad7330b0e1e9c27b308a224210a14f9}{elemMean}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& mat, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t}\& elemIndex) \{}
\DoxyCodeLine{432   assert(mat.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}() -\/ 1 >= elemIndex);}
\DoxyCodeLine{433   T sum(0);}
\DoxyCodeLine{434   \textcolor{keywordtype}{size\_t} index = 0;}
\DoxyCodeLine{435   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < mat.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{436     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < mat.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}(); j++) \{}
\DoxyCodeLine{437       sum += mat(i, j, elemIndex);}
\DoxyCodeLine{438       index++;}
\DoxyCodeLine{439     \}}
\DoxyCodeLine{440   \}}
\DoxyCodeLine{441   \textcolor{keywordflow}{return} sum / index;}
\DoxyCodeLine{442 \}}
\DoxyCodeLine{443 }
\DoxyCodeLine{450 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{451 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_a2e19f18bb0d422da0e75d5d0f6753331}{diag\_elements}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& in) \{}
\DoxyCodeLine{452   \mbox{\hyperlink{classMatrix}{Matrix<T>}} out(0, in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), 1, in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}());}
\DoxyCodeLine{453   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(); i++) \{}
\DoxyCodeLine{454     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} elem = 0; elem < in.\mbox{\hyperlink{classMatrix_ac9d3a0fe5ce995cf6f997209f72199cc}{elements}}(); elem++) \{ out(i, 0, elem) = in(i, i, elem); \}}
\DoxyCodeLine{455   \}}
\DoxyCodeLine{456   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{457 \}}
\DoxyCodeLine{458 }
\DoxyCodeLine{465 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{466 \mbox{\hyperlink{classMatrix}{Matrix<T>}} \mbox{\hyperlink{matrix__utils_8h_af79386365c3901ef0bec8f116368ded2}{unique}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<T>}}\& in, [[maybe\_unused]] \textcolor{keywordtype}{int} axis = 0) \{}
\DoxyCodeLine{467   \textcolor{keywordtype}{bool} row\_wise     = axis == 0;}
\DoxyCodeLine{468   \mbox{\hyperlink{classMatrix}{Matrix<T>}} out     = \mbox{\hyperlink{classMatrix}{Matrix<T>}}(0, in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{469   \textcolor{keywordtype}{size\_t} found\_vals = 0;}
\DoxyCodeLine{470   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < (row\_wise ? in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() : in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}()); ++i) \{}
\DoxyCodeLine{471     \textcolor{keywordtype}{bool} found = \textcolor{keyword}{false};}
\DoxyCodeLine{472     \textcolor{keyword}{auto} xi =}
\DoxyCodeLine{473     in.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(row\_wise ? i : 0, row\_wise ? i : in.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, row\_wise ? 0 : i, row\_wise ? in.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1 : i);}
\DoxyCodeLine{474     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < found\_vals; ++j) \{}
\DoxyCodeLine{475       found = xi}
\DoxyCodeLine{476               == out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(}
\DoxyCodeLine{477               row\_wise ? j : 0, row\_wise ? j : out.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, row\_wise ? 0 : j, row\_wise ? out.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1 : j);}
\DoxyCodeLine{478       \textcolor{keywordflow}{if}(found) \{ \textcolor{keywordflow}{break}; \}}
\DoxyCodeLine{479     \}}
\DoxyCodeLine{480     \textcolor{keywordflow}{if}(!found) \{}
\DoxyCodeLine{481       out.\mbox{\hyperlink{classMatrix_a15c969e68b5492a3e9918a001ba8beb2}{SetSlice}}(found\_vals, xi);}
\DoxyCodeLine{482       found\_vals++;}
\DoxyCodeLine{483     \}}
\DoxyCodeLine{484   \}}
\DoxyCodeLine{485   \textcolor{keywordflow}{return} out.\mbox{\hyperlink{classMatrix_a74deba042f505ff0640028b07c20778e}{GetSlice}}(0, found\_vals -\/ 1);}
\DoxyCodeLine{486 \}}

\end{DoxyCode}
