\hypertarget{Perceptron_8h_source}{}\doxysection{Perceptron.\+h}
\label{Perceptron_8h_source}\index{include/math/ds/Perceptron.h@{include/math/ds/Perceptron.h}}
\mbox{\hyperlink{Perceptron_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include "{}../Matrix.h"{}}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}../matrix\_utils.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Classifier_8h}{Classifier.h}}"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{SGD_8h}{SGD.h}}"{}}}
\DoxyCodeLine{7 }
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{classPerceptron}{Perceptron}} : \textcolor{keyword}{public} \mbox{\hyperlink{classANNClassifier}{ANNClassifier}}}
\DoxyCodeLine{25 \{}
\DoxyCodeLine{26 \textcolor{keyword}{public}:}
\DoxyCodeLine{32   \textcolor{keyword}{explicit} \mbox{\hyperlink{classPerceptron_a499ae65d675aca14c0b803df31199705}{Perceptron}}(\textcolor{keywordtype}{double} \_eta = 0.01, \textcolor{keywordtype}{int} iter = 10)}
\DoxyCodeLine{33     : \mbox{\hyperlink{classANNClassifier}{ANNClassifier}}(\_eta, iter) \{ \}}
\DoxyCodeLine{34 }
\DoxyCodeLine{41   \textcolor{keywordtype}{void} \mbox{\hyperlink{classPerceptron_a430fcf4782a3020add0094f986a1c54e}{fit}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& X, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& y)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{42     \mbox{\hyperlink{classClassifier_a82afce4aff01a4d7292eb43fb38329b8}{initialize\_weights}}(X.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{43     \mbox{\hyperlink{classClassifier_a8688dfb2318e40a7c2f3747b68c96bae}{costs}} = \mbox{\hyperlink{classMatrix}{Matrix<double>}}(0, \mbox{\hyperlink{classANNClassifier_aae9927c5e2e95d69ba5baa9842f36b02}{n\_iter}}, 1);}
\DoxyCodeLine{44     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} iter = 0; iter < \mbox{\hyperlink{classANNClassifier_aae9927c5e2e95d69ba5baa9842f36b02}{n\_iter}}; iter++) \{}
\DoxyCodeLine{45       \textcolor{keywordtype}{int} \_errors   = 0;}
\DoxyCodeLine{46       \textcolor{keyword}{auto} iterable = \mbox{\hyperlink{matrix__utils_8h_a98433477e0327bd2ee165374375275e1}{zip}}(X, y);}
\DoxyCodeLine{47       \textcolor{keywordflow}{for}(\textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem : iterable) \{}
\DoxyCodeLine{48         \textcolor{keyword}{auto} xi     = elem.first;}
\DoxyCodeLine{49         \textcolor{keyword}{auto} target = elem.second;}
\DoxyCodeLine{50 }
\DoxyCodeLine{51         \textcolor{keyword}{auto} output  = \mbox{\hyperlink{classPerceptron_a8ecc2a278aefaf4eea183ae25455d14d}{predict}}(xi);}
\DoxyCodeLine{52         \textcolor{keyword}{auto} delta\_w = (target -\/ output);}
\DoxyCodeLine{53         \mbox{\hyperlink{classClassifier_aa9257aed615a41cac4030fcfc7dc08ca}{update\_weights}}(delta\_w, (delta\_w * xi).Transpose() * \mbox{\hyperlink{classANNClassifier_a2e0e1ac7757c8cb67567c4dd4f42fef8}{eta}});}
\DoxyCodeLine{54         \_errors += \mbox{\hyperlink{classPerceptron_a8f136bf2a36d5a1b83fb02215cacb271}{costFunction}}(delta\_w);}
\DoxyCodeLine{55       \}}
\DoxyCodeLine{56       \mbox{\hyperlink{classClassifier_a8688dfb2318e40a7c2f3747b68c96bae}{costs}}(iter, 0) = \_errors;}
\DoxyCodeLine{57     \}}
\DoxyCodeLine{58   \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{68   \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classPerceptron_adba6029ff33690c1973fa24222f862b8}{netInput}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& X)\textcolor{keyword}{ override }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classSGD_a6e9a27e08c7e4e442b29ad8ca0729bcc}{SGD::netInput}}(X, \mbox{\hyperlink{classClassifier_a5d4d61496164c06deab141329b6c878f}{weights}}); \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{75   \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classPerceptron_a705ba8a2e4c9c5d0884ba9bdf769bd18}{activation}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& X)\textcolor{keyword}{ override }\{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classPerceptron_adba6029ff33690c1973fa24222f862b8}{netInput}}(X); \}}
\DoxyCodeLine{76 }
\DoxyCodeLine{82   \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classPerceptron_a8ecc2a278aefaf4eea183ae25455d14d}{predict}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& X)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{83     std::function<bool(\textcolor{keywordtype}{double})> condition = [](\textcolor{keywordtype}{double} x) \{ \textcolor{keywordflow}{return} bool(x >= 0.0); \};}
\DoxyCodeLine{84     \textcolor{keywordflow}{return} \mbox{\hyperlink{matrix__utils_8h_afb3f7de2743f10b710460feb9c0f9009}{where}}(condition, \mbox{\hyperlink{classPerceptron_a705ba8a2e4c9c5d0884ba9bdf769bd18}{activation}}(X), \{ \{ 1 \} \}, \{ \{ -\/1 \} \});}
\DoxyCodeLine{85   \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{92   \textcolor{keywordtype}{double} \mbox{\hyperlink{classPerceptron_a8f136bf2a36d5a1b83fb02215cacb271}{costFunction}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& X)\textcolor{keyword}{ override }\{ \textcolor{keywordflow}{return} (\textcolor{keywordtype}{double})(X(0, 0) != 0.0); \}}
\DoxyCodeLine{93 \};}
\DoxyCodeLine{94 }

\end{DoxyCode}
