\hypertarget{Fractals_8h_source}{}\doxysection{Fractals.\+h}
\label{Fractals_8h_source}\index{include/math/numerics/Fractals.h@{include/math/numerics/Fractals.h}}
\mbox{\hyperlink{Fractals_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{110 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{newton_8h}{lin\_alg/newton.h}}"{}}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 }
\DoxyCodeLine{118 \textcolor{keyword}{class }\mbox{\hyperlink{classNewtonFractal}{NewtonFractal}}}
\DoxyCodeLine{119 \{}
\DoxyCodeLine{120 \textcolor{keyword}{public}:}
\DoxyCodeLine{122     \textcolor{keywordtype}{double} \mbox{\hyperlink{classNewtonFractal_ac78021b076c2d3a5d3c8b3177ea44bea}{detail}};}
\DoxyCodeLine{124     \textcolor{keywordtype}{double} \mbox{\hyperlink{classNewtonFractal_ab61b91764458edf714b5fbf636ee8800}{xMin}} = -\/1.0, \mbox{\hyperlink{classNewtonFractal_ac710ac326aa58002987217f7fd6198c4}{xMax}} = 1.0;}
\DoxyCodeLine{126     \textcolor{keywordtype}{double} \mbox{\hyperlink{classNewtonFractal_af442f7377e1fa72f5a9431f7536815f7}{yMin}} = -\/1.0, \mbox{\hyperlink{classNewtonFractal_a10bdd859b70e53a4e5bebbf947e4f814}{yMax}} = 1.0;}
\DoxyCodeLine{128     \textcolor{keywordtype}{int} \mbox{\hyperlink{classNewtonFractal_a1725f679c603cdc4630e7b5aa164f94e}{maxIter}} = 100;}
\DoxyCodeLine{130     \textcolor{keywordtype}{double} \mbox{\hyperlink{classNewtonFractal_a6b85a65f2ee58b68f24783615f202263}{tol}} = 1e-\/5;}
\DoxyCodeLine{131 }
\DoxyCodeLine{140     \mbox{\hyperlink{classNewtonFractal_a3aa83a453f1e9132c3bea3b75769125d}{NewtonFractal}}(}
\DoxyCodeLine{141     \textcolor{keywordtype}{double} detailFactor = 1, \textcolor{keywordtype}{double} \_min = -\/1.0, \textcolor{keywordtype}{double} \_max = 1.0, \textcolor{keywordtype}{int} \_maxIter = 100, \textcolor{keywordtype}{double} \_tol = 1e-\/5)}
\DoxyCodeLine{142         : \mbox{\hyperlink{classNewtonFractal_ac78021b076c2d3a5d3c8b3177ea44bea}{detail}}(detailFactor)}
\DoxyCodeLine{143         , \mbox{\hyperlink{classNewtonFractal_ab61b91764458edf714b5fbf636ee8800}{xMin}}(\_min)}
\DoxyCodeLine{144         , \mbox{\hyperlink{classNewtonFractal_ac710ac326aa58002987217f7fd6198c4}{xMax}}(\_max)}
\DoxyCodeLine{145         , \mbox{\hyperlink{classNewtonFractal_af442f7377e1fa72f5a9431f7536815f7}{yMin}}(\_min)}
\DoxyCodeLine{146         , \mbox{\hyperlink{classNewtonFractal_a10bdd859b70e53a4e5bebbf947e4f814}{yMax}}(\_max)}
\DoxyCodeLine{147         , \mbox{\hyperlink{classNewtonFractal_a1725f679c603cdc4630e7b5aa164f94e}{maxIter}}(\_maxIter)}
\DoxyCodeLine{148         , \mbox{\hyperlink{classNewtonFractal_a6b85a65f2ee58b68f24783615f202263}{tol}}(\_tol) \{ \}}
\DoxyCodeLine{149 }
\DoxyCodeLine{155     \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classNewtonFractal_a6cf1dfbd662be4a8ae272020a8edf82d}{operator()}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{156         \textcolor{keywordtype}{size\_t} n = fabs(\mbox{\hyperlink{classNewtonFractal_ac710ac326aa58002987217f7fd6198c4}{xMax}} -\/ \mbox{\hyperlink{classNewtonFractal_ab61b91764458edf714b5fbf636ee8800}{xMin}}) / (1 / (\mbox{\hyperlink{classNewtonFractal_ac78021b076c2d3a5d3c8b3177ea44bea}{detail}} > 10 ? \mbox{\hyperlink{classNewtonFractal_ac78021b076c2d3a5d3c8b3177ea44bea}{detail}} : 10));}
\DoxyCodeLine{157         \textcolor{keyword}{auto} x\_i = \mbox{\hyperlink{numerics_2utils_8h_af9dcfd52b7832ac134ae73f568a90350}{linspace}}(\mbox{\hyperlink{classNewtonFractal_ab61b91764458edf714b5fbf636ee8800}{xMin}}, \mbox{\hyperlink{classNewtonFractal_ac710ac326aa58002987217f7fd6198c4}{xMax}}, n).\mbox{\hyperlink{classMatrix_a054a03bcae4eb86d6f4ef84dc87840ef}{Transpose}}();}
\DoxyCodeLine{158         \textcolor{keyword}{auto} y\_i = \mbox{\hyperlink{numerics_2utils_8h_af9dcfd52b7832ac134ae73f568a90350}{linspace}}(\mbox{\hyperlink{classNewtonFractal_af442f7377e1fa72f5a9431f7536815f7}{yMin}}, \mbox{\hyperlink{classNewtonFractal_a10bdd859b70e53a4e5bebbf947e4f814}{yMax}}, n).\mbox{\hyperlink{classMatrix_a054a03bcae4eb86d6f4ef84dc87840ef}{Transpose}}();}
\DoxyCodeLine{159 }
\DoxyCodeLine{160         \textcolor{keyword}{auto} M = \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(n, n);}
\DoxyCodeLine{161         std::vector<Matrix<double>> roots;}
\DoxyCodeLine{162 }
\DoxyCodeLine{163         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < n; ++i) \{}
\DoxyCodeLine{164             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} j = 0; j < n; ++j) \{}
\DoxyCodeLine{165                 \textcolor{keyword}{auto} res = \mbox{\hyperlink{newton_8h_aacc26d9c74d7d171569d8fed83c6a967}{newton}}(\mbox{\hyperlink{classNewtonFractal_a7b5e57d09efeaebe88ccd017220d3e78}{fun}}, \mbox{\hyperlink{classNewtonFractal_a60e62d9f1cc691d006ef6ea3436f4b33}{jac}}, \{ \{ x\_i(i, 0) \}, \{ y\_i(j, 0) \} \}, \mbox{\hyperlink{classNewtonFractal_a6b85a65f2ee58b68f24783615f202263}{tol}}, \mbox{\hyperlink{classNewtonFractal_a1725f679c603cdc4630e7b5aa164f94e}{maxIter}});}
\DoxyCodeLine{166                 \textcolor{keywordflow}{if}(res.second == \mbox{\hyperlink{classNewtonFractal_a1725f679c603cdc4630e7b5aa164f94e}{maxIter}}) \{}
\DoxyCodeLine{167                     M(i, j) = 0;}
\DoxyCodeLine{168                 \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{169                     \textcolor{keywordtype}{size\_t} index = 0;}
\DoxyCodeLine{170                     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} k = 0; k < roots.size(); ++k) \{}
\DoxyCodeLine{171                         \textcolor{keywordflow}{if}(\mbox{\hyperlink{numerics_2utils_8h_aa1a08a76ee49f8a9717e4aa127984987}{norm}}(res.first -\/ roots[k]) <= \mbox{\hyperlink{classNewtonFractal_a6b85a65f2ee58b68f24783615f202263}{tol}}) \{ index = k; \}}
\DoxyCodeLine{172                     \}}
\DoxyCodeLine{173                     \textcolor{keywordflow}{if}(index == 0) \{}
\DoxyCodeLine{174                         index = roots.size();}
\DoxyCodeLine{175                         roots.push\_back(res.first);}
\DoxyCodeLine{176                     \}}
\DoxyCodeLine{177                     M(i, j) = (double)index;}
\DoxyCodeLine{178                 \}}
\DoxyCodeLine{179             \}}
\DoxyCodeLine{180         \}}
\DoxyCodeLine{181         \textcolor{keywordflow}{return} M;}
\DoxyCodeLine{182     \}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{private}:}
\DoxyCodeLine{197     \textcolor{keyword}{static} \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classNewtonFractal_a7b5e57d09efeaebe88ccd017220d3e78}{fun}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x) \{}
\DoxyCodeLine{198         \textcolor{keywordflow}{return} \mbox{\hyperlink{classMatrix}{Matrix<double>}}(\{ \{ \mbox{\hyperlink{Probability_8h_a4f0f49581ae9315695fb32a1e9fc4bdc}{pow}}(x(0, 0), 3) -\/ 3 * x(0, 0) * x(1, 0) * x(1, 0) -\/ 1 \},}
\DoxyCodeLine{199                                 \{ -\/\mbox{\hyperlink{Probability_8h_a4f0f49581ae9315695fb32a1e9fc4bdc}{pow}}(x(1, 0), 3) + 3 * x(0, 0) * x(0, 0) * x(1, 0) \} \});}
\DoxyCodeLine{200     \}}
\DoxyCodeLine{213     \textcolor{keyword}{static} \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classNewtonFractal_a60e62d9f1cc691d006ef6ea3436f4b33}{jac}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x) \{}
\DoxyCodeLine{214         \textcolor{keywordflow}{return} \mbox{\hyperlink{classMatrix}{Matrix<double>}}(\{ \{ 3 * (x(0, 0) * x(0, 0) -\/ x(1, 0) * x(1, 0)), -\/6 * x(0, 0) * x(1, 0) \},}
\DoxyCodeLine{215                                 \{ 6 * x(0, 0) * x(1, 0), 3 * x(0, 0) * x(0, 0) -\/ 3 * x(1, 0) * x(1, 0) \} \});}
\DoxyCodeLine{216     \}}
\DoxyCodeLine{217 \};}
\DoxyCodeLine{218 }
\DoxyCodeLine{222 \textcolor{keyword}{class }\mbox{\hyperlink{classMandelbrot}{Mandelbrot}}}
\DoxyCodeLine{223 \{}
\DoxyCodeLine{224 \textcolor{keyword}{public}:}
\DoxyCodeLine{226     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classMandelbrot_a02ac592d77e906df905626032b9af8aa}{maxIters}} = 125;}
\DoxyCodeLine{228     \textcolor{keywordtype}{double} \mbox{\hyperlink{classMandelbrot_aaa65ca8561039deb5e74acc4cd2f920f}{startX}} = -\/2.5, \mbox{\hyperlink{classMandelbrot_afdd6e8a3720164279b7b999011ad41d5}{endX}} = 1.0;}
\DoxyCodeLine{230     \textcolor{keywordtype}{double} \mbox{\hyperlink{classMandelbrot_af75cb6f92b971fdc1159248675c03e00}{startY}} = -\/1.0, \mbox{\hyperlink{classMandelbrot_a8722229646bd702577b94eb03fd9dcd2}{endY}} = 1.0;}
\DoxyCodeLine{232     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}} = 500;}
\DoxyCodeLine{233 }
\DoxyCodeLine{234 }
\DoxyCodeLine{238     \mbox{\hyperlink{classMandelbrot_aab7bca81a362bcbfabeae26c3e7fa562}{Mandelbrot}}() \{ \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240 }
\DoxyCodeLine{245     \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{classMandelbrot_a95b6d736a10be7dc60b87afb53923e91}{operator()}}() \{}
\DoxyCodeLine{246         \textcolor{keyword}{auto} stepWidthX = (\mbox{\hyperlink{classMandelbrot_afdd6e8a3720164279b7b999011ad41d5}{endX}} -\/ \mbox{\hyperlink{classMandelbrot_aaa65ca8561039deb5e74acc4cd2f920f}{startX}}) / (\textcolor{keywordtype}{double})\mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}};}
\DoxyCodeLine{247         \textcolor{keyword}{auto} stepWidthY = (\mbox{\hyperlink{classMandelbrot_a8722229646bd702577b94eb03fd9dcd2}{endY}} -\/ \mbox{\hyperlink{classMandelbrot_af75cb6f92b971fdc1159248675c03e00}{startY}}) / (\textcolor{keywordtype}{double})\mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}};}
\DoxyCodeLine{248 }
\DoxyCodeLine{249         \mbox{\hyperlink{classMatrix}{Matrix<double>}} M = \mbox{\hyperlink{numerics_2utils_8h_af5994908a659705a385de5bee89039fc}{zeros}}(\mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}}, \mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}});}
\DoxyCodeLine{250         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} x = 0; x < \mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}}; ++x) \{}
\DoxyCodeLine{251             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} y = 0; y < \mbox{\hyperlink{classMandelbrot_a09a174794619b9f2a13010b4af19d498}{detail}}; ++y) \{}
\DoxyCodeLine{252                 M(x, y) = (double)\mbox{\hyperlink{classMandelbrot_a6b86afb4db2158631df99a45e9821574}{fun}}((\mbox{\hyperlink{classMandelbrot_aaa65ca8561039deb5e74acc4cd2f920f}{startX}} + stepWidthX * (\textcolor{keywordtype}{double})x), (\mbox{\hyperlink{classMandelbrot_af75cb6f92b971fdc1159248675c03e00}{startY}} + stepWidthY * (double)y));}
\DoxyCodeLine{253                 \textcolor{keywordflow}{if}(M(x, y) == (double)\mbox{\hyperlink{classMandelbrot_a02ac592d77e906df905626032b9af8aa}{maxIters}}) \{ M(x, y) = 0; \}}
\DoxyCodeLine{254             \}}
\DoxyCodeLine{255         \}}
\DoxyCodeLine{256         \textcolor{keywordflow}{return} M;}
\DoxyCodeLine{257     \}}
\DoxyCodeLine{258 }
\DoxyCodeLine{259 \textcolor{keyword}{private}:}
\DoxyCodeLine{266     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classMandelbrot_a6b86afb4db2158631df99a45e9821574}{fun}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& real\_c, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& img\_c) \{}
\DoxyCodeLine{267         \textcolor{keywordtype}{size\_t} iters = 0;}
\DoxyCodeLine{268         \textcolor{keywordtype}{double} real  = 0;}
\DoxyCodeLine{269         \textcolor{keywordtype}{double} img   = 0;}
\DoxyCodeLine{270 }
\DoxyCodeLine{271         \textcolor{keywordflow}{while}(++iters < \mbox{\hyperlink{classMandelbrot_a02ac592d77e906df905626032b9af8aa}{maxIters}} \&\& real * real + img * img < 4) \{}
\DoxyCodeLine{272             \textcolor{keywordtype}{double} temp = real;}
\DoxyCodeLine{273             real        = real * real + real\_c -\/ img * img;}
\DoxyCodeLine{274             img         = 2 * img * temp + img\_c;}
\DoxyCodeLine{275         \}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277         \textcolor{keywordflow}{return} iters;}
\DoxyCodeLine{278     \}}
\DoxyCodeLine{279 \};}

\end{DoxyCode}
