\hypertarget{ds_2TestKNN_8cpp-example}{}\doxysection{ds/\+Test\+KNN.\+cpp}
This is an example on how to use the \mbox{\hyperlink{classKNN}{KNN}} class for classification.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}../Test.h"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{DataSet_8h}{math/ds/DataSet.h}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{KNN_8h}{math/ds/KNN.h}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{ds_2utils_8h}{math/ds/utils.h}}>}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{class }KNNTestCase : \textcolor{keyword}{public} Test}
\DoxyCodeLine{\{}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} TestConstructor() \{}
\DoxyCodeLine{    \textcolor{keyword}{auto} clf = \mbox{\hyperlink{classKNN}{KNN}}(1);}
\DoxyCodeLine{    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} TestFit() \{}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} input\_data(}
\DoxyCodeLine{    \{ \{ 2, 1 \}, \{ 4, 1 \}, \{ 2, 3 \}, \{ 4, 3 \}, \{ 8, 6 \}, \{ 10, 8 \}, \{ 2, 12 \}, \{ 2, 14 \}, \{ 4, 14 \} \});}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} labels(\{ \{ 0 \}, \{ 0 \}, \{ 0 \}, \{ 0 \}, \{ 1 \}, \{ 1 \}, \{ 2 \}, \{ 2 \}, \{ 2 \} \});}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} clf = \mbox{\hyperlink{classKNN}{KNN}}(2);}
\DoxyCodeLine{    clf.fit(input\_data, labels);}
\DoxyCodeLine{}
\DoxyCodeLine{    AssertEqual(clf.weights, input\_data);}
\DoxyCodeLine{}
\DoxyCodeLine{    clf = \mbox{\hyperlink{classKNN}{KNN}}(2);}
\DoxyCodeLine{    clf.fit(input\_data, labels);}
\DoxyCodeLine{}
\DoxyCodeLine{    AssertEqual(clf.weights, input\_data);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} TestPredict() \{}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} input\_data(}
\DoxyCodeLine{    \{ \{ 2, 1 \}, \{ 4, 1 \}, \{ 2, 3 \}, \{ 4, 3 \}, \{ 8, 6 \}, \{ 10, 8 \}, \{ 2, 12 \}, \{ 2, 14 \}, \{ 4, 14 \} \});}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} labels(\{ \{ 0 \}, \{ 0 \}, \{ 0 \}, \{ 0 \}, \{ 1 \}, \{ 1 \}, \{ 2 \}, \{ 2 \}, \{ 2 \} \});}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} test\_data(\{ \{ 1, 0 \}, \{ 8, 8 \}, \{ 0, 1 \}, \{ 3, 16 \} \});}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} expected\_labels(\{ \{ 0 \}, \{ 1 \}, \{ 0 \}, \{ 2 \} \});}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} clf = \mbox{\hyperlink{classKNN}{KNN}}(2);}
\DoxyCodeLine{    clf.fit(input\_data, labels);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} predictions = clf.predict(test\_data);}
\DoxyCodeLine{    AssertEqual(predictions, expected\_labels);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{bool} TestPredictionOnIrisData() \{}
\DoxyCodeLine{    \mbox{\hyperlink{structSet}{Set}} dataset  = \mbox{\hyperlink{structSet}{Set}}(\textcolor{stringliteral}{"{}../../tests/ds/iris\_dataset\_train.tsv"{}}, 4, 1);}
\DoxyCodeLine{    \mbox{\hyperlink{structSet}{Set}} test\_set = \mbox{\hyperlink{structSet}{Set}}(\textcolor{stringliteral}{"{}../../tests/ds/iris\_dataset\_test.tsv"{}}, 4, 1);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} clf = \mbox{\hyperlink{classKNN}{KNN}}(10);}
\DoxyCodeLine{    clf.fit(dataset.\mbox{\hyperlink{structSet_a05d1a42371080cffdd7851cf9c00f81b}{Input}}, dataset.\mbox{\hyperlink{structSet_abeb4570e7f558220e76e3fcb03551813}{Output}});}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} preds = clf.predict(test\_set.\mbox{\hyperlink{structSet_a05d1a42371080cffdd7851cf9c00f81b}{Input}});}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keyword}{auto} acc = \mbox{\hyperlink{ds_2utils_8h_a92bb988a831e1ee41cc9f56f9fef9f37}{accuracy}}(preds, test\_set.\mbox{\hyperlink{structSet_abeb4570e7f558220e76e3fcb03551813}{Output}});}
\DoxyCodeLine{}
\DoxyCodeLine{    std::cout << \textcolor{stringliteral}{"{}Iris flower classification, achieved "{}} << acc * 100. << \textcolor{stringliteral}{"{}\% accuracy."{}} << std::endl;}
\DoxyCodeLine{    AssertEqual(acc, 1.0);}
\DoxyCodeLine{    \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} run() \{}
\DoxyCodeLine{    TestConstructor();}
\DoxyCodeLine{    TestFit();}
\DoxyCodeLine{    TestPredict();}
\DoxyCodeLine{    TestPredictionOnIrisData();}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main() \{}
\DoxyCodeLine{  KNNTestCase().run();}
\DoxyCodeLine{  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}

\end{DoxyCodeInclude}
 