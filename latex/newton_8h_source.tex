\hypertarget{newton_8h_source}{}\doxysection{newton.\+h}
\label{newton_8h_source}\index{include/math/numerics/lin\_alg/newton.h@{include/math/numerics/lin\_alg/newton.h}}
\mbox{\hyperlink{newton_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../utils.h"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{gaussSeidel_8h}{gaussSeidel.h}}"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{16 }
\DoxyCodeLine{18 \textcolor{keyword}{using }\mbox{\hyperlink{newton_8h_aa3d3f9218597552f3ff4726daa5d68eb}{Jacobian}} = std::function<Matrix<double>(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&)>;}
\DoxyCodeLine{20 \textcolor{keyword}{using }\mbox{\hyperlink{newton_8h_ae8b65eb11627dab8f1907f164294756b}{LinearEquation}} = std::function<Matrix<double>(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\&)>;}
\DoxyCodeLine{21 }
\DoxyCodeLine{31 std::pair<Matrix<double>, \textcolor{keywordtype}{int}>}
\DoxyCodeLine{32 \mbox{\hyperlink{newton_8h_aacc26d9c74d7d171569d8fed83c6a967}{newton}}(\textcolor{keyword}{const} \mbox{\hyperlink{newton_8h_ae8b65eb11627dab8f1907f164294756b}{LinearEquation}}\& f, \textcolor{keyword}{const} \mbox{\hyperlink{newton_8h_aa3d3f9218597552f3ff4726daa5d68eb}{Jacobian}}\& Df, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x0, \textcolor{keywordtype}{double} TOL, \textcolor{keywordtype}{int} maxIter) \{}
\DoxyCodeLine{33     \textcolor{keyword}{auto} m = x0.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}();}
\DoxyCodeLine{34     \textcolor{keywordflow}{if}(m < 1) \{}
\DoxyCodeLine{35         \textcolor{comment}{// error}}
\DoxyCodeLine{36     \}}
\DoxyCodeLine{37     \textcolor{keyword}{auto} x = x0;}
\DoxyCodeLine{38 }
\DoxyCodeLine{39     \textcolor{keywordtype}{int} iter = 0;}
\DoxyCodeLine{40     \textcolor{keywordtype}{double} r = TOL + 1;}
\DoxyCodeLine{41 }
\DoxyCodeLine{42     \textcolor{keywordflow}{while}(r > TOL \&\& iter < maxIter) \{}
\DoxyCodeLine{43         \textcolor{keyword}{auto} D\_F = Df(x);}
\DoxyCodeLine{44         \textcolor{keyword}{auto} F   = f(x) * -\/1.0;}
\DoxyCodeLine{45 }
\DoxyCodeLine{46         \textcolor{keyword}{auto} delta = \mbox{\hyperlink{gaussSeidel_8h_a7bb1e3f545d858ee2a450500c711f471}{gaussSeidel}}(D\_F, F);}
\DoxyCodeLine{47 }
\DoxyCodeLine{48         x += delta;}
\DoxyCodeLine{49 }
\DoxyCodeLine{50         r = \mbox{\hyperlink{numerics_2utils_8h_aa1a08a76ee49f8a9717e4aa127984987}{norm}}(delta);}
\DoxyCodeLine{51         iter += 1;}
\DoxyCodeLine{52     \}}
\DoxyCodeLine{53     \textcolor{keywordflow}{if}(iter == maxIter) \{}
\DoxyCodeLine{54         \textcolor{comment}{// error max Iter reached, no convergence}}
\DoxyCodeLine{55     \}}
\DoxyCodeLine{56     \textcolor{keywordflow}{return} \{ x, iter \};}
\DoxyCodeLine{57 \}}
\DoxyCodeLine{58 }

\end{DoxyCode}
