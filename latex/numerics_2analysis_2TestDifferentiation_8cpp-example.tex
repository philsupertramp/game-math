\hypertarget{numerics_2analysis_2TestDifferentiation_8cpp-example}{}\doxysection{numerics/analysis/\+Test\+Differentiation.\+cpp}
This is an example on how to use the Differentiation file.


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}../../Test.h"{}}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{Differentiation_8h}{math/numerics/analysis/Differentiation.h}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{Plot_8h}{math/visualization/Plot.h}}>}}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{class }DifferentiationTestCase : \textcolor{keyword}{public} Test}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keywordtype}{int} m             = 10;}
\DoxyCodeLine{    \textcolor{keywordtype}{double} a          = 0;}
\DoxyCodeLine{    \textcolor{keywordtype}{double} b          = 2 * M\_PI;}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} xk = \mbox{\hyperlink{utils_8cpp_a3496a7aecd2c42b9bacd5bc9dc85dd88}{linspace}}(a, b, m).\mbox{\hyperlink{classMatrix_a953e5e97f987f47e261dd830cac64087}{Transpose}}();}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} f(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& in) \{}
\DoxyCodeLine{        \textcolor{keywordflow}{return} in.\mbox{\hyperlink{classMatrix_aab08352f6e89b3dfb616c10998db4570}{Apply}}([](\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& val) \{ \textcolor{keywordflow}{return} cos(val); \});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \mbox{\hyperlink{classMatrix}{Matrix<double>}} df(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& in) \{}
\DoxyCodeLine{        \textcolor{keywordflow}{return} in.\mbox{\hyperlink{classMatrix_aab08352f6e89b3dfb616c10998db4570}{Apply}}([](\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& val) \{ \textcolor{keywordflow}{return} -\/sin(val); \});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{bool} TestDiffs() \{}
\DoxyCodeLine{        \textcolor{keyword}{auto} expected = df(xk);}
\DoxyCodeLine{        \textcolor{keyword}{auto} f\_xk     = f(xk);}
\DoxyCodeLine{        \mbox{\hyperlink{classMatrix}{Matrix<double>}} backward(\{}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ -\/0.84854514524284763 \},}
\DoxyCodeLine{        \{ -\/0.9649299364248537 \},}
\DoxyCodeLine{        \{ -\/0.6298132863519682 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0.62981328635196787 \},}
\DoxyCodeLine{        \{ 0.9649299364248537 \},}
\DoxyCodeLine{        \{ 0.84854514524284785 \},}
\DoxyCodeLine{        \{ 0.33511665007288594 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \});}
\DoxyCodeLine{        \mbox{\hyperlink{classMatrix}{Matrix<double>}} forward(\{}
\DoxyCodeLine{        \{ -\/0.33511665007288566 \},}
\DoxyCodeLine{        \{ -\/0.84854514524284763 \},}
\DoxyCodeLine{        \{ -\/0.9649299364248537 \},}
\DoxyCodeLine{        \{ -\/0.6298132863519682 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0.62981328635196787 \},}
\DoxyCodeLine{        \{ 0.9649299364248537 \},}
\DoxyCodeLine{        \{ 0.84854514524284785 \},}
\DoxyCodeLine{        \{ 0.33511665007288594 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \});}
\DoxyCodeLine{        \mbox{\hyperlink{classMatrix}{Matrix<double>}} central(\{}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ -\/0.90673754083385083 \},}
\DoxyCodeLine{        \{ -\/0.79737161138841095 \},}
\DoxyCodeLine{        \{ -\/0.31490664317598421 \},}
\DoxyCodeLine{        \{ 0.31490664317598377 \},}
\DoxyCodeLine{        \{ 0.79737161138841095 \},}
\DoxyCodeLine{        \{ 0.90673754083385083 \},}
\DoxyCodeLine{        \{ 0.59183089765786689 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \});}
\DoxyCodeLine{        \mbox{\hyperlink{classMatrix}{Matrix<double>}} backward2(\{}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ -\/0.46225496131552568 \},}
\DoxyCodeLine{        \{ 0.31490664317598388 \},}
\DoxyCodeLine{        \{ 0.94471992952795147 \},}
\DoxyCodeLine{        \{ 1.132488261461297 \},}
\DoxyCodeLine{        \{ 0.79035274965184488 \},}
\DoxyCodeLine{        \{ 0.078402402487904935 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \});}
\DoxyCodeLine{        \mbox{\hyperlink{classMatrix}{Matrix<double>}} central4(\{}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ -\/0.38092014495112875 \},}
\DoxyCodeLine{        \{ 0.45883090351816203 \},}
\DoxyCodeLine{        \{ 1.0838898728938249 \},}
\DoxyCodeLine{        \{ 1.201784724648338 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \{ 0 \},}
\DoxyCodeLine{        \});}
\DoxyCodeLine{}
\DoxyCodeLine{        AssertEqual(\mbox{\hyperlink{Differentiation_8h_afbc0e0317d703a2ac2dda605eb51315c}{backwardDiff}}(xk, f\_xk), backward);}
\DoxyCodeLine{        AssertEqual(\mbox{\hyperlink{Differentiation_8h_a282d1cc3f0fa98a4c147c4087dca8225}{forwardDiff}}(xk, f\_xk), forward);}
\DoxyCodeLine{        AssertEqual(\mbox{\hyperlink{Differentiation_8h_a46d9c33d91f346ea5e6778dce6fd4fa0}{centralDiff}}(xk, f\_xk), central);}
\DoxyCodeLine{        AssertEqual(\mbox{\hyperlink{Differentiation_8h_a1e0c09e493158ba851b26266ceda4d27}{backwardDiff2}}(xk, f\_xk), backward2);}
\DoxyCodeLine{        AssertEqual(\mbox{\hyperlink{Differentiation_8h_a22a1229c8a7c12361fa3964b48a59cb9}{centralDiff4}}(xk, f\_xk), central4);}
\DoxyCodeLine{}
\DoxyCodeLine{        \mbox{\hyperlink{classPlot}{Plot}} plot(\textcolor{stringliteral}{"{}diffs"{}});}
\DoxyCodeLine{        plot.\mbox{\hyperlink{classPlot_ad08d9746d9372ce9c14c042e12cb0a45}{AddData}}(\mbox{\hyperlink{Matrix_8h_a9c0fb96647d1de47099f074cf20edf34}{HorizontalConcat}}(xk, expected), \textcolor{stringliteral}{"{}Analytical result"{}});}
\DoxyCodeLine{        plot.\mbox{\hyperlink{classPlot_ad08d9746d9372ce9c14c042e12cb0a45}{AddData}}(\mbox{\hyperlink{Matrix_8h_a9c0fb96647d1de47099f074cf20edf34}{HorizontalConcat}}(xk, \mbox{\hyperlink{Differentiation_8h_a282d1cc3f0fa98a4c147c4087dca8225}{forwardDiff}}(xk, f(xk))), \textcolor{stringliteral}{"{}forward"{}}, \mbox{\hyperlink{Plot_8h_afb6eb4f28419b652027fad41104a6d22a3482666ed13eb44c92df895adbb91e49}{DataTypes::DOTS}});}
\DoxyCodeLine{        plot.\mbox{\hyperlink{classPlot_ad08d9746d9372ce9c14c042e12cb0a45}{AddData}}(\mbox{\hyperlink{Matrix_8h_a9c0fb96647d1de47099f074cf20edf34}{HorizontalConcat}}(xk, \mbox{\hyperlink{Differentiation_8h_afbc0e0317d703a2ac2dda605eb51315c}{backwardDiff}}(xk, f(xk))), \textcolor{stringliteral}{"{}backward"{}}, \mbox{\hyperlink{Plot_8h_afb6eb4f28419b652027fad41104a6d22a3482666ed13eb44c92df895adbb91e49}{DataTypes::DOTS}});}
\DoxyCodeLine{        plot.\mbox{\hyperlink{classPlot_ad08d9746d9372ce9c14c042e12cb0a45}{AddData}}(\mbox{\hyperlink{Matrix_8h_a9c0fb96647d1de47099f074cf20edf34}{HorizontalConcat}}(xk, \mbox{\hyperlink{Differentiation_8h_a46d9c33d91f346ea5e6778dce6fd4fa0}{centralDiff}}(xk, f(xk))), \textcolor{stringliteral}{"{}centralDiff"{}}, \mbox{\hyperlink{Plot_8h_afb6eb4f28419b652027fad41104a6d22a3482666ed13eb44c92df895adbb91e49}{DataTypes::DOTS}});}
\DoxyCodeLine{        plot.\mbox{\hyperlink{classPlot_ad08d9746d9372ce9c14c042e12cb0a45}{AddData}}(\mbox{\hyperlink{Matrix_8h_a9c0fb96647d1de47099f074cf20edf34}{HorizontalConcat}}(xk, \mbox{\hyperlink{Differentiation_8h_a1e0c09e493158ba851b26266ceda4d27}{backwardDiff2}}(xk, f(xk))), \textcolor{stringliteral}{"{}backward2"{}}, \mbox{\hyperlink{Plot_8h_afb6eb4f28419b652027fad41104a6d22a3482666ed13eb44c92df895adbb91e49}{DataTypes::DOTS}});}
\DoxyCodeLine{        plot.\mbox{\hyperlink{classPlot_ad08d9746d9372ce9c14c042e12cb0a45}{AddData}}(\mbox{\hyperlink{Matrix_8h_a9c0fb96647d1de47099f074cf20edf34}{HorizontalConcat}}(xk, \mbox{\hyperlink{Differentiation_8h_a22a1229c8a7c12361fa3964b48a59cb9}{centralDiff4}}(xk, f(xk))), \textcolor{stringliteral}{"{}centralDiff4"{}}, \mbox{\hyperlink{Plot_8h_afb6eb4f28419b652027fad41104a6d22a3482666ed13eb44c92df895adbb91e49}{DataTypes::DOTS}});}
\DoxyCodeLine{        plot();}
\DoxyCodeLine{}
\DoxyCodeLine{        \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{    \}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} run() \{ TestDiffs(); \}}
\DoxyCodeLine{\};}
\DoxyCodeLine{}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main() \{}
\DoxyCodeLine{    DifferentiationTestCase().run();}
\DoxyCodeLine{    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}

\end{DoxyCodeInclude}
 