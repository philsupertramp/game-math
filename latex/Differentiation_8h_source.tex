\hypertarget{Differentiation_8h_source}{}\doxysection{Differentiation.\+h}
\label{Differentiation_8h_source}\index{include/math/numerics/analysis/Differentiation.h@{include/math/numerics/analysis/Differentiation.h}}
\mbox{\hyperlink{Differentiation_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{36 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include "{}../../Matrix.h"{}}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include "{}../utils.h"{}}}
\DoxyCodeLine{40 }
\DoxyCodeLine{51 \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{Differentiation_8h_a03b7286d06d466aedafd5fe7e2fcb636}{forwardDiff}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& y) \{}
\DoxyCodeLine{52     \textcolor{keyword}{auto} df  = \mbox{\hyperlink{utils_8cpp_a4af1fa738f95edd689ad5c984dc5fe7a}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{53     \textcolor{keyword}{auto} dy  = y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(1, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 2, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{54     \textcolor{keyword}{auto} dx  = x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(1, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 2, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{55     \textcolor{keyword}{auto} res = \mbox{\hyperlink{Matrix_8h_a42163c4039e35bb283311ba7d7782bff}{HadamardDiv}}(dy, dx);}
\DoxyCodeLine{56     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < df.rows() -\/ 1; ++i) \{ df.SetRow(i, res.GetSlice(i, i, 0, res.columns() -\/ 1)); \}}
\DoxyCodeLine{57     \textcolor{keywordflow}{return} df;}
\DoxyCodeLine{58 \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{70 \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{Differentiation_8h_a0d1f10df297acbf012f59dbe025a4d85}{backwardDiff}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& y) \{}
\DoxyCodeLine{71     \textcolor{keyword}{auto} df  = \mbox{\hyperlink{utils_8cpp_a4af1fa738f95edd689ad5c984dc5fe7a}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{72     \textcolor{keyword}{auto} dy  = y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(1, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 2, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{73     \textcolor{keyword}{auto} dx  = x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(1, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 2, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{74     \textcolor{keyword}{auto} res = \mbox{\hyperlink{Matrix_8h_a42163c4039e35bb283311ba7d7782bff}{HadamardDiv}}(dy, dx);}
\DoxyCodeLine{75     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 1; i < df.rows(); ++i) \{ df.SetRow(i, res.GetSlice(i, i, 0, res.columns() -\/ 1)); \}}
\DoxyCodeLine{76     \textcolor{keywordflow}{return} df;}
\DoxyCodeLine{77 \}}
\DoxyCodeLine{78 }
\DoxyCodeLine{89 \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{Differentiation_8h_a491c1ed77a5dc36d6e7a2656a0c7a436}{centralDiff}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& y) \{}
\DoxyCodeLine{90     \textcolor{keyword}{auto} df  = \mbox{\hyperlink{utils_8cpp_a4af1fa738f95edd689ad5c984dc5fe7a}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{91     \textcolor{keyword}{auto} dy  = y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(2, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 3, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{92     \textcolor{keyword}{auto} dx  = x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(2, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 3, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{93     \textcolor{keyword}{auto} res = \mbox{\hyperlink{Matrix_8h_a42163c4039e35bb283311ba7d7782bff}{HadamardDiv}}(dy, dx);}
\DoxyCodeLine{94     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 1; i < df.rows() -\/ 1; ++i) \{ df.SetRow(i, res.GetSlice(i, i, 0, res.columns() -\/ 1)); \}}
\DoxyCodeLine{95     \textcolor{keywordflow}{return} df;}
\DoxyCodeLine{96 \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{107 \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{Differentiation_8h_ad0138b0a17dd2be7243b310c3cf5a1f1}{backwardDiff2}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& y) \{}
\DoxyCodeLine{108     \textcolor{keyword}{auto} df = \mbox{\hyperlink{utils_8cpp_a4af1fa738f95edd689ad5c984dc5fe7a}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{109     \textcolor{keyword}{auto} dy = (3 * y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(2, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1))}
\DoxyCodeLine{110               -\/ (4 * y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(1, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 2, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1)) + y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 3, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{111     \textcolor{keyword}{auto} dx  = x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(2, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 3, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{112     \textcolor{keyword}{auto} res = \mbox{\hyperlink{Matrix_8h_a42163c4039e35bb283311ba7d7782bff}{HadamardDiv}}(dy, dx);}
\DoxyCodeLine{113     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 2; i < df.rows(); ++i) \{ df.SetRow(i, res.GetSlice(i, i, 0, res.columns() -\/ 1)); \}}
\DoxyCodeLine{114     \textcolor{keywordflow}{return} df;}
\DoxyCodeLine{115 \}}
\DoxyCodeLine{116 }
\DoxyCodeLine{126 \mbox{\hyperlink{classMatrix}{Matrix<double>}} \mbox{\hyperlink{Differentiation_8h_a29c9f611b1a069da1d521c96b5d817fc}{centralDiff4}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& x, \textcolor{keyword}{const} \mbox{\hyperlink{classMatrix}{Matrix<double>}}\& y) \{}
\DoxyCodeLine{127     \textcolor{keyword}{auto} df = \mbox{\hyperlink{utils_8cpp_a4af1fa738f95edd689ad5c984dc5fe7a}{zeros}}(x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}(), x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}());}
\DoxyCodeLine{128     \textcolor{keyword}{auto} dy = (-\/1 * y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(4, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1))}
\DoxyCodeLine{129               + (8 * y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(3, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 2, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1))}
\DoxyCodeLine{130               -\/ (8 * y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(1, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 4, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1)) -\/ y.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, y.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 5, 0, y.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1);}
\DoxyCodeLine{131     \textcolor{keyword}{auto} dx  = 3 * (x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(4, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 1, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1) -\/ x.\mbox{\hyperlink{classMatrix_a48d5726de651f2cadce0255bd23b6b9b}{GetSlice}}(0, x.\mbox{\hyperlink{classMatrix_a5330adf02b284293259eb9f7c9acaa99}{rows}}() -\/ 5, 0, x.\mbox{\hyperlink{classMatrix_a710d9b6934a24229fe06789f65ed0571}{columns}}() -\/ 1));}
\DoxyCodeLine{132     \textcolor{keyword}{auto} res = \mbox{\hyperlink{Matrix_8h_a42163c4039e35bb283311ba7d7782bff}{HadamardDiv}}(dy, dx);}
\DoxyCodeLine{133     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 2; i < df.rows() -\/ 2; ++i) \{ df.SetRow(i, res.GetSlice(i, i, 0, res.columns() -\/ 1)); \}}
\DoxyCodeLine{134     \textcolor{keywordflow}{return} df;}
\DoxyCodeLine{135 \}}
\DoxyCodeLine{136 }

\end{DoxyCode}
